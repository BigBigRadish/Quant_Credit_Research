Sub embig_top_bottom_25()
'
' embig_top_bottom_25 Macro
' top and bottm 25 - daily, monthly, yearly
'

'
    Selection.AutoFilter
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Sheet1").Select
    Sheets("Sheet1").Name = "Daily Return"
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "Top 25 Yearly Return"
    Sheets("Daily Return").Select
    Range("B1").Select
    ActiveCell.FormulaR1C1 = ""
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "Top 25 Daily Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("N1:N280"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Rows("1:26").Select
    Selection.Copy
    Sheets("Daily Return").Select
    Range("A2").Select
    ActiveSheet.Paste
    Range("A29").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Bottom 25 Daily Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("N1:N280"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Daily Return").Select
    Range("A30").Select
    ActiveSheet.Paste
    Sheets.Add After:=Sheets(Sheets.Count)
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Top 25 Monthly Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("O1:O280"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Sheet2").Select
    Range("A2").Select
    ActiveSheet.Paste
    Range("A29").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Bottom 25 Monthly Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("O1:O280"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Sheet2").Select
    Range("A30").Select
    ActiveSheet.Paste
    Sheets("Sheet2").Select
    Sheets("Sheet2").Name = "Monthly Return"
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets("Sheet3").Select
    Sheets("Sheet3").Name = "Yearly Return"
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Top 25 Yearly Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("P1:P280"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Yearly Return").Select
    Range("A2").Select
    ActiveSheet.Paste
    Sheets("Yearly Return").Select
    Range("A29").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Bottom 25 Yearly Return"
    Sheets("embigwgt").Select
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort.SortFields.Add Key:= _
        Range("P1:P280"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("embigwgt").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Yearly Return").Select
    Range("A30").Select
    ActiveSheet.Paste
    Range("D27").Select
    Sheets("Daily Return").Select
    Range("1:1,29:29").Select
    Range("A29").Activate
    Application.CutCopyMode = False
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Font.Bold = True
    Columns("C:C").EntireColumn.AutoFit
    Columns("N:N").EntireColumn.AutoFit
    Range("N:N,C:C").Select
    Range("C1").Activate
    Selection.Font.Bold = False
    Selection.Font.Bold = True
    Range("C34").Select
    Sheets("Monthly Return").Select
    Range("1:1,29:29").Select
    Range("A29").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Font.Bold = True
    Range("D2").Select
    Columns("C:C").EntireColumn.AutoFit
    Columns("O:O").EntireColumn.AutoFit
    Range("O:O,C:C").Select
    Range("C1").Activate
    Selection.Font.Bold = False
    Selection.Font.Bold = True
    Range("C13").Select
    Sheets("Yearly Return").Select
    Range("1:1,29:29").Select
    Range("A29").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Columns("C:C").EntireColumn.AutoFit
    Columns("O:O").EntireColumn.AutoFit
    Range("O:O,C:C").Select
    Range("C1").Activate
    Selection.Font.Bold = True
    Selection.Font.Bold = False
    Selection.Font.Bold = True
    Range("1:1,29:29").Select
    Range("A29").Activate
    Selection.Font.Bold = True
    Range("C5").Select
    Columns("O:O").ColumnWidth = 6.57
    Columns("O:O").ColumnWidth = 7.86
    Columns("O:O").Select
    Selection.Font.Bold = False
    Columns("Q:Q").Select
    Columns("P:P").EntireColumn.AutoFit
    Columns("P:P").Select
    Selection.Font.Bold = False
    Selection.Font.Bold = True
    Range("D8").Select
    Sheets("Daily Return").Select
    Range("H28").Select
End Sub























Sub bc_top_bottom_50()
'
' bc_top_bottom_50 Macro
'
'
    Sheets(1).Select
    Sheets(1).Select
    Selection.Rows(1).EntireRow.Delete
    Selection.Rows(1).EntireRow.Delete
    Selection.Rows(1).EntireRow.Delete
    Selection.AutoFilter
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets(2).Select
    Sheets(2).Name = "Monthly Return"
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "Top 50 Monthly Return"
    Sheets(1).Select
    Rows("1:1").Select
    ActiveWindow.SmallScroll Down:=15
    Rows("1:51").Select
    ActiveWindow.SmallScroll Down:=-30
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields.Add _
        Key:=Range("M1:M13653"), SortOn:=xlSortOnValues, Order:=xlDescending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets(1).AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveWindow.SmallScroll Down:=18
    Selection.Copy
    Sheets("Monthly Return").Select
    Range("A2").Select
    ActiveSheet.Paste
    ActiveWindow.SmallScroll Down:=33
    Range("A54").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Bottom 50 Monthly Return"
    Sheets(1).Select
    ActiveWindow.SmallScroll Down:=-57
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields.Add _
        Key:=Range("M1:M13653"), SortOn:=xlSortOnValues, Order:=xlAscending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets(1).AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("Monthly Return").Select
    Range("A55").Select
    ActiveSheet.Paste
    ActiveWindow.SmallScroll Down:=-3
    Rows("54:54").Select
    ActiveWindow.SmallScroll Down:=-51
    Range("54:54,1:1").Select
    Range("A1").Activate
    Application.CutCopyMode = False
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Columns("A:A").EntireColumn.AutoFit
    Columns("B:B").EntireColumn.AutoFit
    Columns("M:M").EntireColumn.AutoFit
    Range("M:M,A:A").Select
    Range("A1").Activate
    Selection.Font.Bold = True
    Selection.Font.Bold = False
    Selection.Font.Bold = True
    Columns("E:E").EntireColumn.AutoFit
    Range("E17").Select
    Sheets.Add After:=Sheets(Sheets.Count)
    Sheets(3).Select
    Sheets(3).Name = "3mo Return"
    Sheets("3mo Return").Select
    ActiveCell.FormulaR1C1 = "Top 50 3mo Return"
    Sheets(1).Select
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields.Add _
        Key:=Range("N1:N13653"), SortOn:=xlSortOnValues, Order:=xlDescending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets(1).AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("3mo Return").Select
    Range("A2").Select
    ActiveSheet.Paste
    ActiveWindow.SmallScroll Down:=30
    Range("A54").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Bottom 50 30mo Return"
    Range("A55").Select
    Sheets(1).Select
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets(1).AutoFilter.Sort.SortFields.Add _
        Key:=Range("N1:N13653"), SortOn:=xlSortOnValues, Order:=xlAscending, _
        DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets(1).AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Selection.Copy
    Sheets("3mo Return").Select
    ActiveSheet.Paste
    ActiveWindow.SmallScroll Down:=-6
    Rows("54:54").Select
    ActiveWindow.SmallScroll Down:=-39
    Range("54:54,1:1").Select
    Range("A1").Activate
    Application.CutCopyMode = False
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Columns("A:A").EntireColumn.AutoFit
    Columns("B:B").EntireColumn.AutoFit
    Columns("E:E").EntireColumn.AutoFit
    Columns("N:N").EntireColumn.AutoFit
    Range("N:N,A:A").Select
    Range("A1").Activate
    Selection.Font.Bold = True
    Range("I6").Select
    Sheets("Monthly Return").Select
    ActiveWindow.SmallScroll Down:=-15
    Sheets(1).Select
End Sub




